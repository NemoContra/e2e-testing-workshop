<ng-container *ngrxLet="flightsPageViewModel$; let ctx">
  <h1 testId="headline">Flight Search</h1>

  <form (submit)="search()" [formGroup]="formGroup">
    <div class="form-group">
      <label>From:</label>
      <input
        formControlName="from"
        testId="from"
        class="form-control"
        minlength="3"
        required
      />
    </div>

    <div class="form-group">
      <label>To:</label>
      <input testId="to" class="form-control" formControlName="to" />
    </div>

    <button
      type="submit"
      class="btn"
      [disabled]="!formGroup.value.from || !formGroup.value.to"
      testId="search"
    >
      Search
    </button>
  </form>

  <br />

  <p *ngIf="ctx.flightsLoading">Loading...</p>
  <p *ngIf="ctx.flightsErrorCode as errorCode">Fehler: {{ errorCode }}</p>

  <div class="row" testId="flight-cards">
    <div
      *ngFor="let flight of ctx.flights"
      class="col-xs-12 col-sm-6 col-md-4 col-lg-4 col-xl-3"
    >
      <flight-card
        [selectedFlight]="flight"
        [selected]="basket()[flight.id]"
        (selectedChange)="selectFlight(flight.id, $event)"
      />
    </div>
  </div>

  <div>
    <pre>{{ basket() | json }}</pre>
  </div>
</ng-container>
